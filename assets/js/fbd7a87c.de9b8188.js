"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3039],{3174:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var t=i(5893),d=i(1151);const r={sidebar_position:2,sidebar_label:"Quickstart"},s="Quickstart: Create your first application with LoadShedding",o={id:"getting-started/quickstart",title:"Quickstart: Create your first application with LoadShedding",description:"In this guide, you will use C# and the .NET CLI to create a WebApi that will have LoadShedding with the default configurations.",source:"@site/docs/getting-started/quickstart.md",sourceDirName:"getting-started",slug:"/getting-started/quickstart",permalink:"/loadshedding/docs/getting-started/quickstart",draft:!1,unlisted:!1,editUrl:"https://github.com/farfetch/loadhsedding/tree/main/website/docs/getting-started/quickstart.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Quickstart"},sidebar:"tutorialSidebar",previous:{title:"Installation",permalink:"/loadshedding/docs/getting-started/installation"},next:{title:"Packages",permalink:"/loadshedding/docs/getting-started/packages"}},a={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Overview",id:"overview",level:2},{value:"Steps",id:"steps",level:2},{value:"1. Create a folder for your applications",id:"1-create-a-folder-for-your-applications",level:3},{value:"2. Create WebApi Project",id:"2-create-webapi-project",level:3},{value:"3. Install LoadShedding package",id:"3-install-loadshedding-package",level:3},{value:"4 Add Metrics",id:"4-add-metrics",level:3},{value:"5. Add LoadShedding on the WebApi",id:"5-add-loadshedding-on-the-webapi",level:3},{value:"6. Use LoadShedding on the WebApi",id:"6-use-loadshedding-on-the-webapi",level:3},{value:"7. Run!",id:"7-run",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"quickstart-create-your-first-application-with-loadshedding",children:"Quickstart: Create your first application with LoadShedding"}),"\n",(0,t.jsx)(n.p,{children:"In this guide, you will use C# and the .NET CLI to create a WebApi that will have LoadShedding with the default configurations."}),"\n",(0,t.jsx)(n.p,{children:"By the end of the guide, you will know how to use LoadShedding on your application."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["One of the following .NET versions:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:".NET Core 2.0 or above."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"You will create a WebApi using LoadShedding."}),"\n",(0,t.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,t.jsx)(n.h3,{id:"1-create-a-folder-for-your-applications",children:"1. Create a folder for your applications"}),"\n",(0,t.jsxs)(n.p,{children:["Create a new folder with the name ",(0,t.jsx)(n.em,{children:"LoadSheddingQuickstart"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"2-create-webapi-project",children:"2. Create WebApi Project"}),"\n",(0,t.jsxs)(n.p,{children:["Run the following command to create a WebApi Project named ",(0,t.jsx)(n.em,{children:"LoadSheddingQuickstart"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet new webapi -controllers -n LoadSheddingQuickstart\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-install-loadshedding-package",children:"3. Install LoadShedding package"}),"\n",(0,t.jsxs)(n.p,{children:["Inside the ",(0,t.jsx)(n.em,{children:"LoadSheddingQuickstart"})," project directory, run the following command to install the required package:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet add package Farfetch.LoadShedding.AspNetCore\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-add-metrics",children:"4 Add Metrics"}),"\n",(0,t.jsxs)(n.p,{children:["Inside the ",(0,t.jsx)(n.em,{children:"LoadSheddingQuickstart"})," project directory, run the following command to install Prometheus:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet add package prometheus-net.AspNetCore\ndotnet add package Farfetch.LoadShedding.Prometheus\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["This step is optional. With this you will be able to confirm that LoadShedding is configured on the ",(0,t.jsx)(n.a,{href:"#7-run",children:"Run!"})," step."]})}),"\n",(0,t.jsx)(n.h3,{id:"5-add-loadshedding-on-the-webapi",children:"5. Add LoadShedding on the WebApi"}),"\n",(0,t.jsx)(n.p,{children:"Add the LoadShedding services by calling the AddLoadShedding extension:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"services.AddLoadShedding();\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Optionally you can configure ",(0,t.jsx)(n.code,{children:"SubscribeEvents()"})," and you will be able to confirm that LoadShedding is configured on the ",(0,t.jsx)(n.a,{href:"#7-run",children:"Run!"})," step:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'services.AddLoadShedding((provider, options) =>\n{\n    options.SubscribeEvents(events =>\n    {\n        events.ItemEnqueued.Subscribe(args => Console.WriteLine($"QueueLimit: {args.QueueLimit}, QueueCount: {args.QueueCount}"));\n        events.ItemDequeued.Subscribe(args => Console.WriteLine($"QueueLimit: {args.QueueLimit}, QueueCount: {args.QueueCount}"));\n        events.ItemProcessing.Subscribe(args => Console.WriteLine($"ConcurrencyLimit: {args.ConcurrencyLimit}, ConcurrencyItems: {args.ConcurrencyCount}"));\n        events.ItemProcessed.Subscribe(args => Console.WriteLine($"ConcurrencyLimit: {args.ConcurrencyLimit}, ConcurrencyItems: {args.ConcurrencyCount}"));\n        events.Rejected.Subscribe(args => Console.Error.WriteLine($"Item rejected with Priority: {args.Priority}"));\n    });\n});\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["For more information about de default configurations and possible customizations see ",(0,t.jsx)(n.a,{href:"/loadshedding/docs/guides/adaptative-concurreny-limiter/configuration#options-configuration",children:"here."})]})}),"\n",(0,t.jsx)(n.h3,{id:"6-use-loadshedding-on-the-webapi",children:"6. Use LoadShedding on the WebApi"}),"\n",(0,t.jsxs)(n.p,{children:["Use the ",(0,t.jsx)(n.code,{children:"UseLoadShedding"})," extension method by extending the ",(0,t.jsx)(n.code,{children:"IApplicationBuilder"})," interface:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"app.UseLoadShedding();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"7-run",children:"7. Run!"}),"\n",(0,t.jsxs)(n.p,{children:["From the ",(0,t.jsx)(n.code,{children:"LoadSheddingQuickstart"})," directory run the project:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet run --project LoadSheddingQuickstart/LoadSheddingQuickstart.csproj \n"})}),"\n",(0,t.jsxs)(n.p,{children:["And you should be able to call the available endpoint with Swagger Web Interface: ",(0,t.jsx)(n.a,{href:"https://localhost:7231/swagger/index.html",children:"https://localhost:7231/swagger/index.html"})]}),"\n",(0,t.jsxs)(n.p,{children:["Now, you can confirm that LoadShedding is correctly configured on your WebApi by calling the following endpoint: ",(0,t.jsx)(n.a,{href:"https://localhost:7231/metrics",children:"https://localhost:7231/metrics"})]}),"\n",(0,t.jsxs)(n.p,{children:["You should see the LoadShedding metrics referenced ",(0,t.jsx)(n.a,{href:"/loadshedding/docs/guides/adaptative-concurreny-limiter/configuration#reference-documentation",children:"here"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Additionally, you can also confirm if LoadShedding is correctly configured by checking the following console output:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"ConcurrencyLimit: 5, ConcurrencyItems: 1\nConcurrencyLimit: 5, ConcurrencyItems: 0\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>s});var t=i(7294);const d={},r=t.createContext(d);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);